{"ast":null,"code":"import _regeneratorRuntime from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/danielliu/Documents/ReactProjects/dish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./BigSearchBar.css';import{withRouter}from'react-router-dom';var apiKey='u5mrF79LEqZx7JFwOyifoKT2a3ILGvRE';var BigSearchBar=/*#__PURE__*/function(_React$Component){_inherits(BigSearchBar,_React$Component);var _super=_createSuper(BigSearchBar);function BigSearchBar(props){var _this;_classCallCheck(this,BigSearchBar);_this=_super.call(this,props);var initial='';if(localStorage.getItem('initialLocation')){initial=localStorage.getItem('initialLocation');}_this.state={term:'',location:'',initialLocation:''};_this.handleTermChange=_this.handleTermChange.bind(_assertThisInitialized(_this));_this.handleLocationChange=_this.handleLocationChange.bind(_assertThisInitialized(_this));_this.handleSearch=_this.handleSearch.bind(_assertThisInitialized(_this));return _this;}_createClass(BigSearchBar,[{key:\"handleTermChange\",value:function handleTermChange(e){this.setState({term:e.target.value});}},{key:\"handleLocationChange\",value:function handleLocationChange(e){this.setState({location:e.target.value});}},{key:\"handleSearch\",value:function handleSearch(e){e.preventDefault();if(this.state.location===''){this.setState({location:this.state.initialLocation});this.props.history.push(\"/search?term=\".concat(this.state.term,\"&location=\").concat(this.state.initialLocation));}else{this.props.history.push(\"/search?term=\".concat(this.state.term,\"&location=\").concat(this.state.location));//redirect url\n}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSearch},/*#__PURE__*/React.createElement(\"div\",{className:\"BigSearchBar-fields\"},/*#__PURE__*/React.createElement(\"input\",{placeholder:\"Search by business\",onChange:this.handleTermChange}),/*#__PURE__*/React.createElement(\"input\",{placeholder:\"Enter location\",onChange:this.handleLocationChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"BigSearchBar-submit\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Search\"}))));}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!navigator.geolocation){_context.next=9;break;}_context.prev=1;_context.next=4;return navigator.geolocation.getCurrentPosition(function(pos){var lat=pos.coords.latitude;var long=pos.coords.longitude;return fetch(\"https://www.mapquestapi.com/geocoding/v1/reverse?key=\".concat(apiKey,\"&location=\").concat(lat,\"%2C\").concat(long,\"&outFormat=json&thumbMaps=false\")).then(handleErrors).then(function(jsonResponse){var city=jsonResponse.results[0].locations[0].adminArea5;var state=jsonResponse.results[0].locations[0].adminArea3;var country=jsonResponse.results[0].locations[0].adminArea1;return\"\".concat(city,\", \").concat(state,\", \").concat(country);}).then(function(location){_this2.setState({location:location,initialLocation:location});localStorage.setItem('initialLocation',location);}).catch(function(error){console.log(error);return{};});});case 4:_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[1,6]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()}]);return BigSearchBar;}(React.Component);function handleErrors(response){if(!response.ok){throw Error(response.statusText);}return response.json();}export default withRouter(BigSearchBar);","map":{"version":3,"sources":["/Users/danielliu/Documents/ReactProjects/dish/src/Components/BigSearchBar/BigSearchBar.js"],"names":["React","withRouter","apiKey","BigSearchBar","props","initial","localStorage","getItem","state","term","location","initialLocation","handleTermChange","bind","handleLocationChange","handleSearch","e","setState","target","value","preventDefault","history","push","navigator","geolocation","getCurrentPosition","pos","lat","coords","latitude","long","longitude","fetch","then","handleErrors","jsonResponse","city","results","locations","adminArea5","adminArea3","country","adminArea1","setItem","catch","error","console","log","Component","response","ok","Error","statusText","json"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './BigSearchBar.css';\nimport { withRouter } from 'react-router-dom';\n\nconst apiKey = 'u5mrF79LEqZx7JFwOyifoKT2a3ILGvRE';\n\nclass BigSearchBar extends React.Component {\n    constructor(props) {\n\t\tsuper(props);\n\t\tlet initial = '';\n\t\tif(localStorage.getItem('initialLocation')) {\n\t\t\tinitial = localStorage.getItem('initialLocation');\n\t\t}\n\t\tthis.state = {\n\t\t\tterm: '',\n\t\t\tlocation: '',\n\t\t\tinitialLocation: ''\n\t\t};\n\t\tthis.handleTermChange = this.handleTermChange.bind(this);\n\t\tthis.handleLocationChange = this.handleLocationChange.bind(this);\n\t\tthis.handleSearch = this.handleSearch.bind(this);\n    }\n    handleTermChange(e) {\n\tthis.setState({term: e.target.value});\n    }\n    handleLocationChange(e) {\n\tthis.setState({location: e.target.value});\n\t}\n\thandleSearch(e) {\n\t\te.preventDefault();\n\t\tif(this.state.location === '') {\n\t\t\tthis.setState({location: this.state.initialLocation});\n\t\t\tthis.props.history.push(`/search?term=${this.state.term}&location=${this.state.initialLocation}`);\n\t\t} else {\n\t\t\tthis.props.history.push(`/search?term=${this.state.term}&location=${this.state.location}`); //redirect url\n\t\t}\n\t}\n    render() {\n\treturn (\n\t\t<div >\n\t\t\t<form onSubmit = {this.handleSearch}>\n\t\t\t\t<div className = \"BigSearchBar-fields\">\n\t\t\t\t\t<input placeholder = \"Search by business\" onChange = {this.handleTermChange}/>\n\t\t\t\t\t<input placeholder = \"Enter location\"  onChange = {this.handleLocationChange}/>\n\t\t\t\t</div>\n\t\t\t\t<div className = \"BigSearchBar-submit\">\n\t\t\t\t\t<input type = 'submit' value = 'Search'/>\n\t\t\t\t</div>\n\t\t\t</form>\n\t    </div>\n\t);\n\t}\n\t\n\tasync componentDidMount() { //fetch location from mapquest api\n\t\tif(navigator.geolocation) {\n\t\t\ttry {\n\t\t\t\tawait navigator.geolocation.getCurrentPosition((pos) => {\n\t\t\t\t\tconst lat = pos.coords.latitude;\n\t\t\t\t\tconst long = pos.coords.longitude;\n\t\t\t\t\treturn fetch(`https://www.mapquestapi.com/geocoding/v1/reverse?key=${apiKey}&location=${lat}%2C${long}&outFormat=json&thumbMaps=false`)\n\t\t\t\t\t.then(handleErrors)\n\t\t\t\t\t.then(jsonResponse => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst city = jsonResponse.results[0].locations[0].adminArea5;\n\t\t\t\t\t\tconst state = jsonResponse.results[0].locations[0].adminArea3;\n\t\t\t\t\t\tconst country = jsonResponse.results[0].locations[0].adminArea1;\n\t\t\t\t\t\treturn `${city}, ${state}, ${country}`;\n\t\t\t\t\t})\n\t\t\t\t\t.then(location => {\n\t\t\t\t\t\tthis.setState({location: location, initialLocation: location});\n\t\t\t\t\t\tlocalStorage.setItem('initialLocation', location);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t\treturn {};\n\t\t\t\t\t});\n\t\t\t\t});\t\n\t\t\t} catch (error){\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction handleErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText);\n    }\n    return response.json();\n}\n\n\nexport default withRouter(BigSearchBar);\n"]},"metadata":{},"sourceType":"module"}